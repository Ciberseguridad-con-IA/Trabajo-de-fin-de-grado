# -*- coding: utf-8 -*-
"""DataSet-Generator.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/18lg7DyYlja2rDIzjScCTxuHxde4oUtIh
"""

!pip install huggingface_hub

import os
import json
from google.colab import drive, userdata
from huggingface_hub import login, HfApi

HF_TOKEN = userdata.get('HF_TOKEN')
login(HF_TOKEN)

drive.mount('/content/drive')
files_path = '/content/drive/MyDrive/TFG-Ciber/Data-Set-Nacho/Answers/'
dataset_path = '/content/drive/MyDrive/TFG-Ciber/Data-Set-Nacho/Datasets/'

json_files = [f for f in os.listdir(files_path) if f.endswith('.json')]
combined_data = []
for file_name in json_files:
    file_path = os.path.join(files_path, file_name)
    with open(file_path, 'r', encoding='utf-8') as f:
        data = json.load(f)
        combined_data.extend(data)

dataset_name = "Def-All-2"
version = "v3"
path = dataset_path + dataset_name + version + ".json"
with open(path, "w") as f:
    json.dump(combined_data, f, indent=4)

api = HfApi()

api.create_repo(dataset_name, repo_type="dataset")

api.upload_file(
    path_or_fileobj=path,
    path_in_repo=dataset_name + ".json",
    repo_id="NachoRedNav/" + dataset_name,
    repo_type="dataset"
)